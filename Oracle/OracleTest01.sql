/*
    날짜 2025 0718
    이름 최민수
    내용 sql 연습문제1 (총 30)
*/

-- 실습 1-1
/*ALTER SESSION SET "_ORACLE_SCRIPT"=true;
CREATE USER shop IDENTIFIED BY 1234;
GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO shop;*/
-- 실습 1-2
create table Customer(
    CID     VARCHAR2(20) PRIMARY KEY,
    name    VARCHAR2(20) NOT NULL,
    hp      CHAR(13) UNIQUE,
    address VARCHAR2(200),
    RDATE   date    NOT NULL
);

CREATE TABLE PRODUCT 
(
  PNO NUMBER(4) NOT NULL 
, PNAME VARCHAR2(30) NOT NULL 
, STOCK NUMBER DEFAULT 0 NOT NULL 
, PRICE NUMBER 
, COMPANY VARCHAR2(20) NOT NULL 
);

CREATE TABLE ORDERS (
    ORD_NO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ORD_CID VARCHAR2(20) NOT NULL,
    ORD_PNO NUMBER(4) NOT NULL,
    ORD_CNT NUMBER DEFAULT 1 NOT NULL ,
    ORD_DATE DATE NOT NULL
);

-- 실습 1-3

INSERT INTO Customer VALUES ('C101', '김유신', '010-1234-1001', '김해시 봉황동', '2022-01-01');
INSERT INTO Customer VALUES ('C102', '김춘추', '010-1234-1002', '경주시 보문동', '2022-01-02', 'YYYY-MM-DD'));
INSERT INTO Customer VALUES ('C103', '장보고', '010-1234-1003', '완도군 청산면', '2022-01-03');
INSERT INTO Customer VALUES ('C104', '강감찬', '010-1234-1004', '서울시 마포구', '2022-01-04');
INSERT INTO Customer VALUES ('C105', '이성계', NULL, NULL, '2022-01-05'); 
INSERT INTO Customer VALUES ('C106', '정철', '010-1234-1006', '경기도 용인시', TO_DATE('2022-01-06', 'YYYY-MM-DD'));
INSERT INTO Customer VALUES ('C107', '허준', NULL, NULL, '2022-01-07');
INSERT INTO Customer VALUES ('C108', '이순신', '010-1234-1008', '서울시 영등포구', '2022-01-08');
INSERT INTO Customer VALUES ('C109', '송상현', '010-1234-1009', '부산시 동래구', '2022-01-09');
INSERT INTO Customer VALUES ('C110', '정약용', '010-1234-1010', '경기도 광주시', '2022-01-10');


INSERT INTO Product VALUES (1, '새우깡', 5000, 1500, '농심');
INSERT INTO Product VALUES (2, '초코파이', 2500, 2500, '오리온');
INSERT INTO Product VALUES (3, '포카칩', 3600, 1700, '오리온');
INSERT INTO Product VALUES (4, '양파링', 1250, 1800, '농심');
INSERT INTO Product VALUES (5, '죠리퐁', 2200, NULL, '크라운');
INSERT INTO Product VALUES (6, '마가렛트', 3500, 3500, '롯데');
INSERT INTO Product VALUES (7, '뿌셔뿌셔', 1650, 1200, '오뚜기');

INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C102', 3, 2, TO_DATE('2022-07-01 13:15:10', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C101', 4, 1, TO_DATE('2022-07-01 14:16:11', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C108', 1, 1, TO_DATE('2022-07-01 17:23:18', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C109', 6, 5, TO_DATE('2022-07-02 10:46:36', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C102', 2, 1, TO_DATE('2022-07-03 09:15:37', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C101', 7, 3, TO_DATE('2022-07-03 12:35:12', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C110', 1, 2, TO_DATE('2022-07-03 16:55:36', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C104', 2, 4, TO_DATE('2022-07-04 14:23:23', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C102', 1, 3, TO_DATE('2022-07-04 21:54:34', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO Orders (ORD_CID, ORD_PNO, ORD_CNT, ORD_DATE) VALUES ('C107', 6, 1, TO_DATE('2022-07-05 14:21:03', 'YYYY-MM-DD HH24:MI:SS'));



-- 실습 1-4
SELECT * FROM CUSTOMER;

-- 실습 1-5
SELECT CID, NAME, HP FROM CUSTOMER;

-- 실습 1-6
SELECT * FROM PRODUCT;

-- 실습 1-7
SELECT COMPANY FROM PRODUCT;

-- 실습 1-8
SELECT DISTINCT COMPANY FROM PRODUCT;

-- 실습 1-9
SELECT PNAME, PRICE FROM PRODUCT;

-- 실습 1-10
SELECT PNAME, PRICE+500 조정단가 FROM PRODUCT;

-- 실습 1-11
SELECT PNAME, STOCK, PRICE FROM PRODUCT WHERE COMPANY = '오리온';

-- 실습 1-12 (시 분 초 왜 안나와)
SELECT ORD_PNO, ORD_CNT, ORD_DATE FROM ORDERS WHERE ORD_CID = 'C102';

-- 실습 1-13
SELECT ORD_PNO, ORD_CNT, ORD_DATE FROM ORDERS WHERE ORD_CID = 'C102' AND ORD_CNT >= 2;

-- 실습 1-14
SELECT * FROM PRODUCT WHERE PRICE BETWEEN 1000 AND 2000;

-- 실습 1-15
SELECT CID, NAME, HP, ADDRESS FROM CUSTOMER WHERE NAME LIKE '김%';

-- 실습 1-16
SELECT CID, NAME, HP, ADDRESS FROM CUSTOMER WHERE NAME LIKE '__';

-- 실습 1-17
SELECT * FROM CUSTOMER WHERE HP IS NULL;

-- 실습 1-18
SELECT * FROM CUSTOMER WHERE ADDRESS IS NOT NULL;

-- 실습 1-19
SELECT * FROM CUSTOMER ORDER BY RDATE DESC;

-- 실습 1-20
SELECT * FROM ORDERS WHERE ORD_CNT >=3 ORDER BY ORD_CNT DESC, ORD_CID ASC;

-- 실습 1-21
SELECT AVG(PRICE) FROM PRODUCT;

-- 실습 1-22
SELECT SUM(STOCK) FROM PRODUCT WHERE COMPANY = '농심';

-- 실습 1-23
SELECT COUNT(*) 고객수 FROM CUSTOMER;

-- 실습 1-24
SELECT COUNT(DISTINCT COMPANY) "제조업체 수" FROM PRODUCT;

-- 실습 1-25
SELECT ORD_PNO "주문 상품번호", SUM(ORD_CNT) "총 주문수량" FROM ORDERS GROUP BY ORD_PNO;

-- 실습 1-26
SELECT COMPANY "제조업체", COUNT(*) "제품수", MAX(PRICE) "최고가" FROM PRODUCT
    GROUP BY COMPANY;

-- 실습 1-27
SELECT COMPANY "제조업체", COUNT(*) "제품수", MAX(PRICE) "최고가" FROM PRODUCT
    GROUP BY COMPANY HAVING COUNT(COMPANY) > 1;

-- 실습 1-28
SELECT ORD_PNO, ORD_CID, SUM(ORD_CNT) "총 주문수량" FROM ORDERS
    GROUP BY ORD_CID, ORD_PNO
    ORDER BY ORD_PNO;

-- 실습 1-29
SELECT ORD_CID, PNAME FROM ORDERS A
    JOIN PRODUCT P ON A.ORD_PNO = P.PNO
    WHERE ORD_CID = 'C102';


-- 실습 1-30
SELECT ORD_CID, NAME, PNAME, ORD_DATE FROM ORDERS A
 JOIN CUSTOMER B ON A.ORD_CID = B.CID
 JOIN PRODUCT C ON A.ORD_PNO = C.PNO
 WHERE TRUNC(ORD_DATE) = TO_DATE('22-07-03', 'YY-MM-DD');
